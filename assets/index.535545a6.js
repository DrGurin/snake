var f=Object.defineProperty;var u=(s,e,i)=>e in s?f(s,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[e]=i;var t=(s,e,i)=>(u(s,typeof e!="symbol"?e+"":e,i),i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const r of h.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function i(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerpolicy&&(h.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?h.credentials="include":a.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function o(a){if(a.ep)return;a.ep=!0;const h=i(a);fetch(a.href,h)}})();class m{constructor(e){t(this,"element");t(this,"context");this.element=document.createElement("canvas"),this.element&&(this.context=this.element.getContext("2d"),this.element.width=320,this.element.height=400,e&&e.appendChild(this.element))}}class c{constructor(){t(this,"step");t(this,"maxStep");t(this,"sizeCell");t(this,"sizeBerry");this.step=0,this.maxStep=6,this.sizeCell=16,this.sizeBerry=this.sizeCell/4}}class y{constructor(e,i){t(this,"isGamePaused");t(this,"frameId");t(this,"update");t(this,"draw");t(this,"config");this.isGamePaused=!1,this.update=e,this.draw=i,this.config=new c,this.animate=this.animate.bind(this),this.frameId=this.animate()}animate(){if(this.isGamePaused)return;this.frameId&&cancelAnimationFrame(this.frameId);const e=requestAnimationFrame(this.animate);if(!(++this.config.step<this.config.maxStep))return this.config.step=0,this.update(),this.draw(),e}pauseGame(){this.isGamePaused=!this.isGamePaused,this.isGamePaused||(this.frameId=requestAnimationFrame(this.animate))}}const g=s=>{s.x=160,s.y=160,s.dx=s.config.sizeCell,s.dy=0,s.tails=[],s.maxTails=3,s.head={x:0,y:0},s.neck={x:0,y:0}};class p{constructor(){t(this,"config");t(this,"x");t(this,"y");t(this,"dx");t(this,"dy");t(this,"tails");t(this,"maxTails");t(this,"head");t(this,"neck");this.config=new c,this.x=160,this.y=160,this.dx=this.config.sizeCell,this.dy=0,this.tails=[],this.maxTails=3,this.head={x:0,y:0},this.neck={x:0,y:0}}update(e,i,o){!o||(this.x+=this.dx,this.y+=this.dy,this.x<0?this.x=o.width-this.config.sizeCell:this.x>=o.width&&(this.x=0),this.y<0?this.y=o.height-this.config.sizeCell:this.y>=o.height&&(this.y=0),this.tails.unshift({x:this.x,y:this.y}),this.tails.length>this.maxTails&&this.tails.pop(),this.tails.forEach((a,h)=>{a.x===e.x&&a.y===e.y&&(this.maxTails++,i.incScore(),e.randomPosition());for(let r=h+1;r<this.tails.length;r++)a.x==this.tails[r].x&&a.y==this.tails[r].y&&(this.death(),i.setToZero(),e.randomPosition())}),this.head=this.tails[0],this.neck=this.tails[1])}draw(e){this.tails.forEach((i,o)=>{o==0?e.fillStyle="#FA0556":e.fillStyle="#A00034",e.fillRect(i.x,i.y,this.config.sizeCell,this.config.sizeCell)})}death(){g(this)}moveUp(){var e,i;((e=this.head)==null?void 0:e.y)===((i=this.neck)==null?void 0:i.y)&&(this.dy=-this.config.sizeCell,this.dx=0)}moveDown(){var e,i;((e=this.head)==null?void 0:e.y)===((i=this.neck)==null?void 0:i.y)&&(this.dy=this.config.sizeCell,this.dx=0)}moveRight(){var e,i;((e=this.head)==null?void 0:e.y)!==((i=this.neck)==null?void 0:i.y)&&(this.dx=this.config.sizeCell,this.dy=0)}moveLeft(){var e,i;((e=this.head)==null?void 0:e.y)!==((i=this.neck)==null?void 0:i.y)&&(this.dx=-this.config.sizeCell,this.dy=0)}}class w{constructor(e,i=0){t(this,"score");t(this,"scoreBlock");this.scoreBlock=document.querySelector(e),this.score=i,this.draw()}incScore(){this.score++,this.draw()}setToZero(){this.score=0,this.draw()}draw(){!this.scoreBlock||(this.scoreBlock.innerHTML=`${this.score}`)}}function d(s,e){return Math.floor(Math.random()*(e-s)+s)}class x{constructor(e){t(this,"canvas");t(this,"config");t(this,"x");t(this,"y");this.x=0,this.y=0,this.canvas=e,this.config=new c,this.randomPosition()}draw(e){e.beginPath(),e.fillStyle="#A00034",e.arc(this.x+this.config.sizeCell/2,this.y+this.config.sizeCell/2,this.config.sizeBerry,0,2*Math.PI),e.fill()}randomPosition(){this.x=d(0,this.canvas.element.width/this.config.sizeCell)*this.config.sizeCell,this.y=d(0,this.canvas.element.height/this.config.sizeCell)*this.config.sizeCell}}const l=class{constructor(e,i){this.key=e,this.value=i}toString(){return this.key}};let n=l;t(n,"Up",new l("Up",["KeyW","ArrowUp"])),t(n,"Down",new l("Down",["KeyS","ArrowDown"])),t(n,"Left",new l("Left",["KeyA","ArrowLeft"])),t(n,"Right",new l("Right",["KeyD","ArrowRight"])),t(n,"Pause",new l("Pause",["KeyP","Space"]));class v{constructor(e){t(this,"canvas");t(this,"snake");t(this,"berry");t(this,"score");t(this,"gameLoop");this.canvas=new m(e),this.snake=new p,this.berry=new x(this.canvas),this.score=new w(".game-score .score-count",0),this.gameLoop=new y(this.update.bind(this),this.draw.bind(this)),this.control()}update(){!this.canvas||this.snake.update(this.berry,this.score,this.canvas.element)}draw(){var e,i;!((e=this.canvas)!=null&&e.context)||!((i=this.canvas)!=null&&i.element)||(this.canvas.context.clearRect(0,0,this.canvas.element.width,this.canvas.element.height),this.snake.draw(this.canvas.context),this.berry.draw(this.canvas.context))}control(){document.addEventListener("keydown",e=>{!this.gameLoop.isGamePaused&&n.Up.value.includes(e.code)?this.snake.moveUp():!this.gameLoop.isGamePaused&&n.Left.value.includes(e.code)?this.snake.moveLeft():!this.gameLoop.isGamePaused&&n.Down.value.includes(e.code)?this.snake.moveDown():!this.gameLoop.isGamePaused&&n.Right.value.includes(e.code)?this.snake.moveRight():n.Pause.value.includes(e.code)&&this.gameLoop.pauseGame()})}}new v(document.querySelector(".canvas-wrapper"));
